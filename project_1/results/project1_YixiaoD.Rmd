---
title: "project1_YixiaoD"
output: html_document
---
# Background
UMD(Urban Ministries of Durham) is a non-profit orgnization which connects with the community to end homelessness and fight poverty by offering food, shelter and a future to neighbors in need. This project is designed to dig into the data provided by UMD and find something valuable for the staff who are working for the orgnization.  
In this project, I want to predict whether a person comes for help will come back again based on the aid he gets this time, the times of he came before and the average aid he got before. 

# Data
The data source is provided by UMD and the raw data file is given in the data dictionary.

# Data transformation
First, I want to see how many records are there in each year.
```{r include = FALSE}
library(tidyverse)

#read dataset
raw_df <- read_tsv("/Users/Yixiao/Desktop/611project/project_1/data/UMD_Services_Provided_20190719.tsv")
```
```{r}
#separate Date and change type
df <- separate(raw_df, Date, into = c("month", "day", "year"), sep = "/")
df$month <- as.numeric(df$month)
df$day <- as.numeric(df$day)
df$year <- as.numeric(df$year)

#count how many people com for help each year
count_year <- df %>% group_by(year) %>% summarise(count = n())
ggplot(count_year) +
  geom_point(aes(year, count))
```

From the figure we can see that there are little records before 2001. This is consistent with the history of UMD: In 2001, the Durham Community Shelter for HOPE, St. Philipâ€™s Community Cafe, and the United Methodist Mission Society merged to form Urban Ministries of Durham (From UMD website). 
Therefore, we delete the records in the years before 2001. Also, we need to delete those records which happen in the future (after Sep 2019).
```{r}
df <- df %>%
  filter(year >= 2001 & year <= 2019) %>%
  filter(year < 2019 | (year == 2019 & month <=9))
```

Second, I want to merge the "Client File Number" and "Client File Merge" into one columns. In this way, different members in a family who come for help will be considered as one client. To achieve this, I use loop statement. For each record, if the Client File Merge is not 0, the replace the Client File Number with Client File Merge.
```{r}
#fill the missing value with 0
df[is.na(df)] <- 0
# merge Client file Number
for (i in 1:nrow(df)) {
  if (df[i,"Client File Merge"] != 0) {
    df[i,"Client File Number"] = df[i,"Client File Merge"]
  }
}
df <- select(df, -`Client File Merge`)
```


```{r}
come_times <- df %>%
  group_by(`Client File Number`) %>%
  summarise(coming_times = n())
ggplot(come_times) +
  geom_bar(aes(coming_times)) + 
  xlim(0,50)
```







